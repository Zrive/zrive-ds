
import pandas as pd
from sklearn.model_selection import GroupShuffleSplit
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns



df = pd.read_csv('feature_frames.csv')

group_column = 'user_id'
# Inicializa el divisor con GroupShuffleSplit
gss = GroupShuffleSplit(n_splits=1, train_size=0.7, test_size=0.3, random_state=42)

# Realiza la división manteniendo 'user_id' o 'order_id' agrupados
for train_idx, test_idx in gss.split(df, groups=df[group_column]):
    train_val = df.iloc[train_idx]
    test = df.iloc[test_idx]

# Ahora divide train_val en train y val
train_val_gss = GroupShuffleSplit(n_splits=1, train_size=(5/7), test_size=(2/7), random_state=42)

for train_idx, val_idx in train_val_gss.split(train_val, groups=train_val[group_column]):
    train = train_val.iloc[train_idx]
    val = train_val.iloc[val_idx]

# Mostrar solo el número de muestras en cada subconjunto
print(f"Train samples: {train.shape[0]}")
print(f"Validation samples: {val.shape[0]}")
print(f"Test samples: {test.shape[0]}")
